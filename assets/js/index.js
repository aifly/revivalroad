webpackJsonp([0],{0:function(module,exports,__webpack_require__){try{(function(){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),_get=function(t,e,i){for(var a=!0;a;){var n=t,r=e,o=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var c=Object.getPrototypeOf(n);if(null===c)return;t=c,e=r,i=o,a=!0,s=c=void 0}},_react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(32),_reactDom2=_interopRequireDefault(_reactDom),_jquery=__webpack_require__(172),_jquery2=_interopRequireDefault(_jquery),_iscroll=__webpack_require__(173),_iscroll2=_interopRequireDefault(_iscroll);__webpack_require__(174);var _reactFastclick=__webpack_require__(178),_reactFastclick2=_interopRequireDefault(_reactFastclick),_componentsPublicObserable=__webpack_require__(179),_componentsPublicObserable2=_interopRequireDefault(_componentsPublicObserable),_stageIndexJsx=__webpack_require__(180),_stageIndexJsx2=_interopRequireDefault(_stageIndexJsx),_shareIndexJsx=__webpack_require__(187),_shareIndexJsx2=_interopRequireDefault(_shareIndexJsx),_indexIndexJsx=__webpack_require__(190),_indexIndexJsx2=_interopRequireDefault(_indexIndexJsx);(0,_reactFastclick2.default)();var obserable=new _componentsPublicObserable2.default,worksid="1275459017";worksid="8986148900";var data={wxappid:"wx5ec3d35069383211",wxappsecret:"d94ea41d9cd2ba03c7cab5fc0e212cec"};data={wxappid:"wxfacf4a639d9e3bcc",wxappsecret:"149cdef95c99ff7cab523d8beca86080"};var App=function(_Component){function App(t){_classCallCheck(this,App),_get(Object.getPrototypeOf(App.prototype),"constructor",this).call(this,t),this.state={audioState:!1},this.viewW=document.documentElement.clientWidth,this.viewH=document.documentElement.clientHeight,window.s=this,this.zmitiMap=[{name:"北京市",log:"116.46",lat:"39.92"},{name:"上海市",log:"121.48",lat:"31.22"},{name:"天津市",log:"117.2",lat:"39.13"},{name:"重庆市",log:"106.54",lat:"29.59"},{name:"石家庄",log:"114.48",lat:"38.03"},{name:"太原市",log:"112.53",lat:"37.87"},{name:"沈阳市",log:"123.38",lat:"41.8"},{name:"长春市",log:"125.35",lat:"43.88"},{name:"哈尔滨市",log:"126.63",lat:"45.75"},{name:"杭州市",log:"120.19",lat:"30.26"},{name:"福州市",log:"119.3",lat:"26.08"},{name:"济南市",log:"106.54",lat:"29.59"},{name:"郑州市",log:"113.65",lat:"34.76"},{name:"武汉市",log:"114.31",lat:"30.52"},{name:"长沙市",log:"113",lat:"28.21"},{name:"广州市",log:"113.23",lat:"23.16"},{name:"海口市",log:"110.35",lat:"20.02"},{name:"成都市",log:"104.06",lat:"30.67"},{name:"贵阳市",log:"106.71",lat:"26.57"},{name:"昆明市",log:"102.73",lat:"25.04"},{name:"南昌市",log:"115.89",lat:"28.68"},{name:"西安市",log:"108.95",lat:"34.27"},{name:"西宁市",log:"101.74",lat:"36.56"},{name:"兰州市",log:"103.73",lat:"36.03"},{name:"南宁市",log:"106.54",lat:"29.59"},{name:"乌鲁木齐市",log:"87.68",lat:"43.77"},{name:"呼和浩特市",log:"111.65",lat:"40.82"},{name:"拉萨市",log:"91.11",lat:"29.97"},{name:"银川市",log:"106.27",lat:"38.47"},{name:"台北市",log:"121.5",lat:"25.14"},{name:"香港",log:"114.17",lat:"22.27"},{name:"澳门",log:"113.33",lat:"22.13"},{name:"合肥市",log:"117.27",lat:"31.86"},{name:"南京市",log:"118.78",lat:"32.04"}]}return _inherits(App,_Component),_createClass(App,[{key:"render",value:function(){var t={obserable:obserable,wxConfig:this.wxConfig.bind(this),changeURLPar:this.changeURLPar.bind(this),nickname:this.state.nickname,worksid:worksid},e=this.state.src;return _react2.default.createElement("div",{className:"zmiti-main-ui"},!e&&_react2.default.createElement(_stageIndexJsx2.default,t),!e&&_react2.default.createElement(_shareIndexJsx2.default,t),!e&&_react2.default.createElement(_indexIndexJsx2.default,t),e&&_react2.default.createElement(_shareIndexJsx2.default,t),_react2.default.createElement("audio",{ref:"audio",loop:!0,autoPlay:!0,src:"./assets/music/bg.MP3"}),_react2.default.createElement("div",{className:"zmiti-audio",onClick:this.toggleMusic.bind(this)},this.state.audioState&&_react2.default.createElement("img",{src:"./assets/images/bg-ico2.png",className:"zmiit-rotation"}),!this.state.audioState&&_react2.default.createElement("img",{src:"./assets/images/bg-ico1.png"})))}},{key:"dragStart",value:function(t,e){}},{key:"createList",value:function(){for(var t=this.state.picLen*this.state.picLen,e=[],i=0;i<t;i++)e.push(i);return e}},{key:"wxConfig",value:function(t,e,i,a){var n="wxfacf4a639d9e3bcc",r=a||location.href.split("#")[0],o=encodeURIComponent(r);_jquery2.default.ajax({type:"get",url:"http://api.zmiti.com/weixin/jssdk.php?type=signature&durl="+o,dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonFlickrFeed",error:function(){},success:function(a){wx.config({debug:!1,appId:n,timestamp:"1488558145",nonceStr:"Wm3WZYTPz0wzccnW",signature:a.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t,link:r,imgUrl:i,desc:e,success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:t,link:r,imgUrl:i,type:"link",dataUrl:"",desc:e,success:function(){},cancel:function(){}}),wx.onMenuShareQQ({title:t,link:r,imgUrl:i,desc:e,success:function(){},cancel:function(){}})})}})}},{key:"log",value:function(t){_jquery2.default.ajax({url:"http://api.zmiti.com/v2/msg/send_msg",data:{type:t.key||"log",content:JSON.stringify(t),to:""}})}},{key:"getQueryString",value:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?i[2]:null}},{key:"changeURLPar",value:function changeURLPar(url,arg,val){var pattern=arg+"=([^&]*)",replaceText=arg+"="+val;return url.match(pattern)?url.replace(eval("/("+arg+"=)([^&]*)/gi"),replaceText):url.match("[?]")?url+"&"+replaceText:url+"?"+replaceText}},{key:"componentDidMount",value:function(){var t=this,e=this,i=e.getQueryString("src");this.setState({src:i}),this.wxConfig(window.share.title,window.share.desc,window.clipShare.img);var a=this.refs.audio;setTimeout(function(){(0,_jquery2.default)(window).scrollTop(1)},0),a.play(),document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.invoke("getNetworkType",{},function(t){a.play()})},!1),a.addEventListener("play",function(){t.setState({audioState:!0})}),a.addEventListener("pause",function(){t.setState({audioState:!1})}),(0,_jquery2.default)(document).one("touchstart",function(){a.paused&&a.play()})}},{key:"toggleMusic",value:function(){var t=this.refs.audio;t[t.paused?"play":"pause"]()}},{key:"isWeiXin",value:function(){var t=window.navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)}}]),App}(_react.Component);_reactDom2.default.render(_react2.default.createElement(App,null),document.getElementById("fly-main-ui"))}).call(this)}finally{}},174:function(t,exports,e){var i=e(175);"string"==typeof i&&(i=[[t.id,i,""]]);e(177)(i,{});i.locals&&(t.exports=i.locals)},175:function(t,exports,e){exports=t.exports=e(176)(),exports.push([t.id,".lt-full{width:100%;height:100%;position:absolute;left:0;top:0}.zmiti-text-overflow{overflow:hidden;white-space:nowrap;word-break:break-all;text-overflow:ellipsis;-webkit-text-overflow:ellipsis}body,canvas,dd,div,dl,dt,figure,footer,h1,h2,h3,h4,header,html,li,ol,p,section,ul,video{padding:0;margin:0}a{text-decoration:none}li{list-style:none}body,html{height:100%;-webkit-tap-highlight-color:transparent}body{font-family:Helvetica Neue,Helvetica,Microsoft YaHei,\\\\5FAE\\8F6F\\96C5\\9ED1,arial,sans-serif;overflow-x:hidden;font-size:14px}img{border:none;vertical-align:middle;width:100%;height:auto}.clearfix{clear:both}input,textarea{outline:none}#fly-main-ui{height:100%}.zmiti-main-ui{width:100%;height:100%;position:absolute}.zmiti-audio{position:absolute;z-index:440000;width:1rem;height:1rem;right:.5rem;top:.5rem}.zmiit-rotation{-webkit-animation:bgSound 5s linear infinite;animation:bgSound 5s linear infinite}@-webkit-keyframes bgSound{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""])},176:function(t,exports){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var i=this[e];i[2]?t.push("@media "+i[2]+"{"+i[1]+"}"):t.push(i[1])}return t.join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},n=0;n<this.length;n++){var r=this[n][0];"number"==typeof r&&(a[r]=!0)}for(n=0;n<e.length;n++){var o=e[n];"number"==typeof o[0]&&a[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),t.push(o))}},t}},177:function(t,exports,e){function i(t,e){for(var i=0;i<t.length;i++){var a=t[i],n=f[a.id];if(n){n.refs++;for(var r=0;r<n.parts.length;r++)n.parts[r](a.parts[r]);for(;r<a.parts.length;r++)n.parts.push(l(a.parts[r],e))}else{for(var o=[],r=0;r<a.parts.length;r++)o.push(l(a.parts[r],e));f[a.id]={id:a.id,refs:1,parts:o}}}}function a(t){for(var e=[],i={},a=0;a<t.length;a++){var n=t[a],r=n[0],o=n[1],s=n[2],l=n[3],c={css:o,media:s,sourceMap:l};i[r]?i[r].parts.push(c):e.push(i[r]={id:r,parts:[c]})}return e}function n(t,e){var i=h(),a=b[b.length-1];if("top"===t.insertAt)a?a.nextSibling?i.insertBefore(e,a.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),b.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");i.appendChild(e)}}function r(t){t.parentNode.removeChild(t);var e=b.indexOf(t);e>=0&&b.splice(e,1)}function o(t){var e=document.createElement("style");return e.type="text/css",n(t,e),e}function s(t){var e=document.createElement("link");return e.rel="stylesheet",n(t,e),e}function l(t,e){var i,a,n;if(e.singleton){var l=v++;i=g||(g=o(e)),a=c.bind(null,i,l,!1),n=c.bind(null,i,l,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=s(e),a=m.bind(null,i),n=function(){r(i),i.href&&URL.revokeObjectURL(i.href)}):(i=o(e),a=u.bind(null,i),n=function(){r(i)});return a(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;a(t=e)}else n()}}function c(t,e,i,a){var n=i?"":a.css;if(t.styleSheet)t.styleSheet.cssText=w(e,n);else{var r=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(r,o[e]):t.appendChild(r)}}function u(t,e){var i=e.css,a=e.media;if(a&&t.setAttribute("media",a),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function m(t,e){var i=e.css,a=e.sourceMap;a&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var n=new Blob([i],{type:"text/css"}),r=t.href;t.href=URL.createObjectURL(n),r&&URL.revokeObjectURL(r)}var f={},p=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},d=p(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),h=p(function(){return document.head||document.getElementsByTagName("head")[0]}),g=null,v=0,b=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=d()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=a(t);return i(n,e),function(t){for(var r=[],o=0;o<n.length;o++){var s=n[o],l=f[s.id];l.refs--,r.push(l)}if(t){var c=a(t);i(c,e)}for(var o=0;o<r.length;o++){var l=r[o];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete f[l.id]}}}};var w=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}()},178:function(t,exports,e){"use strict";!function(){var i=function(t){return function(){var e=t.createElement,i=8,a=1e3,n=["clientX","clientY","pageX","pageY","screenX","screenY","radiusX","radiusY"],r={downPos:{},lastPos:{}},o=function(t){if(!t)return!1;var e=t.getAttribute("disabled");return e!==!1&&null!==e},s=function(t,e){var i=e||t.currentTarget;i&&!o(i)&&i.focus()},l={input:function(t){s(t),t.stopPropagation()},textarea:function(t){s(t),t.stopPropagation()},select:function(t){s(t),t.stopPropagation()},label:function(t){var e,i=t.currentTarget.getAttribute("for");e=i?document.getElementById(i):t.currentTarget.querySelectorAll("input, textarea, select")[0],e&&s(t,e)}},c=function(t){"function"==typeof t.persist&&t.persist(),t.fastclick=!0,t.type="click",t.button=0},u=function(t,e){if("function"==typeof e.persist&&e.persist(),t)for(var i=0;i<n.length;i+=1){var a=n[i];e[a]=t[a]}},m=function(){return!r.touched&&(!r.lastTouchDate||(new Date).getTime()>r.lastTouchDate+a)},f=function(t){r.invalid=t.touches&&t.touches.length>1||r.invalid},p=function(t,e){var i=!m();i&&e.target!==r.target&&e.preventDefault(),"function"!=typeof t||i||t(e),"click"===e.type&&(r.invalid=!1,r.touched=!1,r.moved=!1)},d=function(t,e){r.invalid=!1,r.moved=!1,r.touched=!0,r.target=e.target,r.lastTouchDate=(new Date).getTime(),u(e.touches[0],r.downPos),u(e.touches[0],r.lastPos),f(e),"function"==typeof t&&t(e)},h=function(t,e){r.touched=!0,r.lastTouchDate=(new Date).getTime(),u(e.touches[0],r.lastPos),f(e),(Math.abs(r.downPos.clientX-r.lastPos.clientX)>i||Math.abs(r.downPos.clientY-r.lastPos.clientY)>i)&&(r.moved=!0),"function"==typeof t&&t(e)},g=function(t,e,i,a){if(r.touched=!0,r.lastTouchDate=(new Date).getTime(),f(a),"function"==typeof t&&t(a),!r.invalid&&!r.moved){var n=a.currentTarget.getBoundingClientRect();r.lastPos.clientX-(r.lastPos.radiusX||0)<=n.right&&r.lastPos.clientX+(r.lastPos.radiusX||0)>=n.left&&r.lastPos.clientY-(r.lastPos.radiusY||0)<=n.bottom&&r.lastPos.clientY+(r.lastPos.radiusY||0)>=n.top&&(o(a.currentTarget)||("function"==typeof e&&(u(r.lastPos,a),c(a),e(a)),!a.defaultPrevented&&l[i]&&l[i](a)))}},v=function(t,e){var i={};for(var a in e)i[a]=e[a];return i.onClick=p.bind(null,e.onClick),i.onMouseDown=p.bind(null,e.onMouseDown),i.onMouseMove=p.bind(null,e.onMouseMove),i.onMouseUp=p.bind(null,e.onMouseUp),i.onTouchStart=d.bind(null,e.onTouchStart),i.onTouchMove=h.bind(null,e.onTouchMove),i.onTouchEnd=g.bind(null,e.onTouchEnd,e.onClick,t),"function"==typeof Object.freeze&&Object.freeze(i),i};if(t.createElement=function(){var t=Array.prototype.slice.call(arguments),i=t[0],a=t[1];return i&&"string"==typeof i&&(a&&"function"==typeof a.onClick||l[i])&&(t[1]=v(i,a||{})),e.apply(null,t)},"object"==typeof t.DOM)for(var b in t.DOM)t.DOM[b]=t.createElement.bind(null,b)}},a=e(1);t.exports=i(a)}()},179:function(t,exports,e){try{(function(){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),a=function(){function t(){e(this,t),this.handlers={}}return i(t,[{key:"on",value:function(t,e){this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e)}},{key:"trigger",value:function(t){if(t.target||(t.target=this),this.handlers[t.type]instanceof Array)for(var e=this.handlers[t.type],i=0,a=e.length;i<a;i++)return e[i](t.data)}}]),t}();exports.default=a,t.exports=exports.default}).call(this)}finally{}},180:function(t,exports,e){try{(function(){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),o=function(t,e,i){for(var a=!0;a;){var n=t,r=e,o=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var c=Object.getPrototypeOf(n);if(null===c)return;t=c,e=r,i=o,a=!0,s=c=void 0}},s=e(1),l=i(s),c=e(32),u=(i(c),e(172)),m=i(u);e(181);var f=e(183),p=e(184),d=i(p),h=function(t){function e(t){a(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.viewW=document.documentElement.clientWidth,this.viewH=document.documentElement.clientHeight,this.state={className:"",points:[],clipurl:"",btns:[{src:"./assets/images/1.png",id:1},{src:"./assets/images/2.png",id:2},{src:"./assets/images/3.png",id:3},{src:"./assets/images/4.png",id:4},{src:"./assets/images/5.png",id:5},{src:"./assets/images/6.png",id:6}],pointStyle:[],clock:0,showFile:!0,maskContent:"",count:0,uploadimg:"",canvasSize:.9*document.documentElement.clientWidth,transX:0,transY:0,scale:1,finishContent:"",toast:"",meteors:[{width:100,top:0,left:this.viewW,WebkitAnimationDelay:"500ms"},{top:200,width:100,left:this.viewW,WebkitAnimationDelay:"2500ms"},{top:300,width:100,left:this.viewW,WebkitAnimationDelay:"1500ms"},{top:400,width:100,left:this.viewW,WebkitAnimationDelay:"1500ms"},{top:500,width:100,left:this.viewW,WebkitAnimationDelay:"1000ms"}],imgLoaded:!1,rotate:0},window.ss=this}return n(e,t),r(e,[{key:"render",value:function(){var t=this,e={background:"url(./assets/images/bg.jpg) no-repeat center top",backgroundSize:"cover"},i={background:"url(./assets/images/clock.png) no-repeat center ",backgroundSize:"contain"};return l.default.createElement("div",{className:"zmiti-stage-main-ui "+this.state.className,style:e},l.default.createElement("audio",{src:"./assets/music/right.mp3",ref:"right"}),l.default.createElement("audio",{src:"./assets/music/error.mp3",ref:"error"}),l.default.createElement("audio",{src:"./assets/music/success.mp3",ref:"success"}),l.default.createElement("audio",null),l.default.createElement("canvas",{ref:"canvas",width:"320",height:"568"}),l.default.createElement("div",{className:"zmiti-top",style:i},l.default.createElement("div",{className:"zmiti-clock"},this.state.clock)),l.default.createElement("div",{className:"zmiti-stage-point-C"},this.state.points.map(function(e,i){var a={};return t.state.pointStyle[i]&&(a={WebkitTransform:"translate("+t.state.pointStyle[i].x+"px,"+t.state.pointStyle[i].y+"px)",transform:"translate("+t.state.pointStyle[i].x+"px,"+t.state.pointStyle[i].y+"px)"}),l.default.createElement("div",{onClick:t.play.bind(t,t.state.btns[i].id,e),key:i,className:"zmiti-point "+e.className,style:a},l.default.createElement("div",{className:"zmiti-meteor",ref:"meteor-"+i},l.default.createElement("img",{src:"./assets/images/m.png"})),l.default.createElement("img",{src:t.state.btns[i].src}))}),l.default.createElement("div",{className:"zmiti-point"},l.default.createElement("img",{src:"./assets/images/7.png"}))),this.state.toast&&l.default.createElement(d.default,{toast:this.state.toast}),this.state.finishContent&&this.state.meteors.map(function(t,e){return l.default.createElement("div",{key:e,className:"zmiti-m",style:t},l.default.createElement("img",{src:"./assets/images/m.png"}))}),this.state.uploadimg&&this.state.imgLoaded&&l.default.createElement("div",{className:"zmiti-img-operator"},l.default.createElement("header",null,l.default.createElement("span",{onClick:function(){t.setState({uploadimg:""})}},"取消"),l.default.createElement("span",{onClick:this.entryShare.bind(this)},"确定")),l.default.createElement("div",{className:"zmiti-img-C"},l.default.createElement("img",{ref:"zmiti-img",src:this.state.uploadimg}),l.default.createElement("div",{ref:"clip",style:{WebkitTransform:"translate("+this.state.transX+"px,"+this.state.transY+"px) ",transform:"translate("+this.state.transX+"px,"+this.state.transY+"px) ",width:this.state.canvasSize,height:this.state.canvasSize}},l.default.createElement("canvas",{ref:"clipcanvas",width:this.state.canvasSize,height:this.state.canvasSize})))),l.default.createElement("div",{className:"zmiti-xiaoxin"},l.default.createElement("img",{src:"./assets/images/xiaoxin.png"}),l.default.createElement("img",{src:"./assets/images/tip.png"})),this.state.maskContent&&l.default.createElement("div",{onClick:function(){t.setState({maskContent:""})},className:"zmiti-error-mask"},l.default.createElement("img",{src:this.state.maskContent||"./assets/images/finish.png"}))," ",this.state.finishContent&&l.default.createElement("div",{className:"zmiti-error-mask"},l.default.createElement("div",{onClick:this.openUploadDialog.bind(this)},l.default.createElement("div",{className:"zmiti-drag"},l.default.createElement("span",null,"恭喜你用时",l.default.createElement("span",{style:{color:"#fff36a"}}," ",this.state.clock,"S")," 走完复兴之路， 点击下方按钮来张合影吧！"),l.default.createElement("img",{src:"./assets/images/ok-text.png"})),!this.state.clipurl&&l.default.createElement("img",{className:"zmiti-finish-content",src:this.state.finishContent}),l.default.createElement("section",{ref:"zmiti-clip-img",style:{WebkitTransform:"rotate("+this.state.rotate+"deg) scale("+this.state.scale+")",transform:"rotate("+this.state.rotate+"deg) scale("+this.state.scale+")"}},l.default.createElement("img",{style:{left:this.state.transX,top:this.state.transY},className:this.state.clipurl?"":"zmiti-rimg",src:this.state.clipurl||"./assets/images/7.png"})),this.state.clipurl&&!this.state.isShare&&!1&&l.default.createElement("article",null,l.default.createElement("img",{onClick:this.entryShare.bind(this),src:"./assets/images/ok.png"})),this.state.showFile&&l.default.createElement("input",{accept:"image/*",type:"file",ref:"file",onChange:this.upload.bind(this)})))," ")}},{key:"rotate",value:function(){this.setState({rotate:(this.state.rotate+90)%360})}},{key:"openUploadDialog",value:function(){(0,m.default)(this.refs.file).trigger("click")}},{key:"entryShare",value:function(){var t=this.props.obserable,e=this;setTimeout(function(){e.refs["zmiti-clip-img"].classList.add("active"),e.setState({scale:.3,isShare:!0})},1e3),setTimeout(function(){t.trigger({type:"setHeadimg",data:{headimg:e.state.clipurl,count:e.personCount,clock:e.state.clock,rotate:e.state.rotate,transX:e.state.transX,transY:e.state.transY}}),e.setState({finishContent:"",className:"hide"})},2e3)}},{key:"upload",value:function(){var t=this,e=(this.props.obserable,new FormData);this.setState({showUploadLoading:!0,toast:"上传中,请稍候..."});var i=this;e.append("setupfile",this.refs.file.files[0]),e.append("uploadtype",0),m.default.ajax({type:"POST",contentType:!1,processData:!1,url:"http://api.zmiti.com/v2/share/upload_file/",data:e}).done(function(e){if(console.log(e),0===e.getret){var a=e.getfileurl[0].datainfourl;m.default.ajax({type:"post",url:"http://api.zmiti.com/v2/aiapi/detect",data:{imageurl:a}}).done(function(e){0===e.getret?0===e.airesult.result_num?t.showToast("未检测到人脸,请重新上传"):t.setState({clipurl:a,toast:""},function(){e.airesult.result[0].rotation_angle!==-90&&(i.setState({showFile:!1}),i.entryShare())}):t.showToast("上传失败，请重试")})}},function(){})}},{key:"setImgPos",value:function(){var t=this,e=(0,m.default)(this.refs["zmiti-clip-img"]);e.on("touchstart",function(i){var i=i.originalEvent.changedTouches[0],a=i.pageX-e[0].offsetLeft-t.state.transX,n=i.pageY-e[0].offsetTop-t.state.transY;(0,m.default)(document).on("touchmove",function(e){var e=e.originalEvent.changedTouches[0],i=e.pageX-a,r=e.pageY-n;t.setState({transX:i,transY:r},function(){})}).on("touchend",function(t){var t=t.originalEvent.changedTouches[0];(0,m.default)(document).off("touchmove touchend")})})}},{key:"setDrag",value:function(){var t=document.createElement("canvas"),e=new Image;e.crossOrigin="anonymous",e.onload=function(){var i=this;t.width=e.width,t.height=e.height;var a=t.getContext("2d");a.drawImage(e,0,0),t.className="zmiti-canvas",document.body.appendChild(t),this.setState({imgLoaded:!0},function(){var t=(0,m.default)(i.refs.clip),a=i.refs["zmiti-img"];a.crossOrigin="anonymous",a.onload=function(){if(a.width>a.height){i.refs.clipcanvas;i.setState({canvasSize:a.height},function(){i.drawImage(e)})}else i.drawImage(e)},t.on("touchstart",function(n){var n=n.originalEvent.changedTouches[0],r=n.pageX-t[0].offsetLeft-i.state.transX,o=n.pageY-t[0].offsetTop-i.state.transY;(0,m.default)(document).on("touchmove",function(t){var t=t.originalEvent.changedTouches[0],n=t.pageX-r,s=t.pageY-o;n<=0&&(n=0),s<=0&&(s=0),n>a.width-i.state.canvasSize&&(n=a.width-i.state.canvasSize),s>a.height-i.state.canvasSize&&(s=a.height-i.state.canvasSize),i.setState({transX:n,transY:s},function(){i.drawImage(e)})}).on("touchend",function(t){var t=t.originalEvent.changedTouches[0];(0,m.default)(document).off("touchmove touchend")})})})}.bind(this),e.src=this.state.uploadimg}},{key:"drawImage",value:function(t){var e=this.refs.clipcanvas,i=(this.refs["zmiti-img"],e.getContext("2d")),a=1;i.clearRect(0,0,this.state.canvasSize,this.state.canvasSize),i.drawImage(t,this.state.transX*a,this.state.transY*a,this.state.canvasSize*a,this.state.canvasSize*a,0,0,this.state.canvasSize,this.state.canvasSize)}},{key:"saveResult",value:function(){var t=this,e=this.props.worksid;m.default.ajax({type:"post",url:"http://api.zmiti.com/v2/h5/save_userusetime/",data:{workid:e,usetime:this.state.clock}}).done(function(e){0===e.getret&&(t.personCount=e.count||20)})}},{key:"play",value:function(t,e){var i=this,a=t-1;if(!(t-1<this.state.count)){var n=this.refs[t-1===this.state.count?"right":"error"];n.currentTime=0,n.play(),t-1===this.state.count?(this.drawLine(60*this.state.pointStyle[t-1].index),this.state.points[t-1].className="active",this.setState({count:this.state.count+1},function(){i.state.count>=i.state.btns.length&&(clearInterval(i.timer),i.refs.success.play(),i.saveResult(),setTimeout(function(){i.setState({finishContent:"./assets/images/finish.png"})},1e3))}),this.refs["meteor-"+a].classList.add("show"),setTimeout(function(){i.refs["meteor-"+a].classList.remove("show")},1e3)):(this.refs["meteor-"+a].classList.add("error"),setTimeout(function(){i.refs["meteor-"+a].classList.remove("error")},700))}}},{key:"beginTranslate",value:function(){var t=this;this.state.pointStyle=this.mess(this.state.pointStyle),this.forceUpdate(),this.timer2=setTimeout(function(){t.timer=setInterval(function(){t.setState({clock:t.state.clock+1})},1e3)},2e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer1),clearTimeout(this.timer2)}},{key:"mess",value:function(t){for(var e,i,a,n=Math.floor,r=Math.random,o=t.length,s=n(o/2)+1;s--;)if(e=n(r()*o),i=n(r()*o),e!==i){a=t[e];t.concat([])[e].index,t.concat([])[i].index;t[e]=t[i],t[i]=a}return e=n(r()*o),t.push.apply(t,t.splice(0,e)),t}},{key:"createPoints",value:function(){for(var t=[],e=this.viewW/3|1,i=6,a=0;a<i;a++){var n=Math.sin(360*a/i*Math.PI/180)*e,r=Math.cos(360*a/i*Math.PI/180)*e;t.push({x:Math.round(n),y:Math.round(r),index:a,className:""})}return this.state.points=t.concat([]),this.defaultPoints=t,this.forceUpdate(),t}},{key:"createLine",value:function(){var t=this.createPoints(),e=this.refs.canvas;e.width=this.viewW,e.height=this.viewH;var i=e.getContext("2d");i.translate(e.width/2,e.height/2),i.beginPath(),t.map(function(t,e){i[0===e?"moveTo":"lineTo"](t.x,t.y)}),i.closePath();var a=new Image;this.line=a,this.context=i,a.src="./assets/images/line.png"}},{key:"drawLine",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];setTimeout(function(){var i=t.context,a=t.line;i.save(),i.rotate(Math.PI/180*-e),i.drawImage(a,-34,0),i.restore()},600)}},{key:"animate",value:function(){var t=this;setTimeout(function(){t.state.points.forEach(function(e,i){t.state.pointStyle.push(e)}),t.forceUpdate(),t.beginTranslate()},300)}},{key:"componentDidMount",value:function(){var t=this;this.createLine();var e=this.props.obserable;e.on("stageAnimate",function(e){t.animate()})}},{key:"showToast",value:function(t,e){var i=this;this.setState({toast:t}),setTimeout(function(){i.setState({toast:""}),e&&e()},2e3)}},{key:"getQueryString",value:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?i[2]:null}}]),e}(s.Component);exports.default=(0,f.PubCom)(h),t.exports=exports.default}).call(this)}finally{}},181:function(t,exports,e){var i=e(182);"string"==typeof i&&(i=[[t.id,i,""]]);e(177)(i,{});i.locals&&(t.exports=i.locals)},182:function(t,exports,e){exports=t.exports=e(176)(),exports.push([t.id,'.lt-full{width:100%;height:100%;position:absolute;left:0;top:0}.zmiti-text-overflow{overflow:hidden;white-space:nowrap;word-break:break-all;text-overflow:ellipsis;-webkit-text-overflow:ellipsis}.zmiti-canvas{position:fixed;z-index:10000;left:0;top:0;border:1px solid red;background:#fff}.zmiti-stage-main-ui{position:absolute;left:0;overflow:hidden;top:0;width:100%;height:100%;z-index:2041;background:#f8f7e5;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.zmiti-stage-main-ui.hide{display:none}.zmiti-stage-main-ui .zmiti-stage-point-C{position:absolute;width:100%;height:100%;left:0;top:0}.zmiti-stage-main-ui .zmiti-m{position:absolute;-webkit-animation:meteorMove 3s infinite;animation:meteorMove 3s infinite}.zmiti-stage-main-ui .zmiti-point{width:80px;height:80px;position:absolute;left:50%;border-radius:50%;top:50%;text-align:center;line-height:80px;color:#fff;margin-left:-40px;margin-top:-40px;z-index:1}.zmiti-stage-main-ui .zmiti-point>img{position:relative;z-index:1}.zmiti-stage-main-ui .zmiti-point .zmiti-meteor{position:absolute;z-index:0;-webkit-transform:translate3d(800px,-800px,0);transform:translate3d(800px,-800px,0)}.zmiti-stage-main-ui .zmiti-point .zmiti-meteor.show{transition:.5s;-webkit-transform:translate3d(40px,-40px,0);transform:translate3d(40px,-40px,0)}.zmiti-stage-main-ui .zmiti-point .zmiti-meteor.error{transition:1s;-webkit-transform:translate3d(-400px,400px,0);transform:translate3d(-400px,400px,0)}.zmiti-stage-main-ui .zmiti-point:last-of-type:after,.zmiti-stage-main-ui .zmiti-point:last-of-type:before{display:none}.zmiti-stage-main-ui .zmiti-point.active:after,.zmiti-stage-main-ui .zmiti-point.active:before{content:"";position:absolute;width:100%;height:100%;left:0;top:0;z-index:-1;border-radius:50%;-webkit-animation:ripples 2s linear infinite;animation:ripples 2s linear infinite}.zmiti-stage-main-ui .zmiti-point.active:before{-webkit-animation:ripples 2s 1s linear infinite;animation:ripples 2s 1s linear infinite}.zmiti-stage-main-ui .zmiti-point:first-of-type,.zmiti-stage-main-ui .zmiti-point:nth-of-type(2),.zmiti-stage-main-ui .zmiti-point:nth-of-type(3),.zmiti-stage-main-ui .zmiti-point:nth-of-type(4),.zmiti-stage-main-ui .zmiti-point:nth-of-type(5),.zmiti-stage-main-ui .zmiti-point:nth-of-type(6){transition:-webkit-transform .3s 0s;transition:transform .3s 0s;transition:transform .3s 0s,-webkit-transform .3s 0s}.zmiti-stage-main-ui .zmiti-translate{width:100px;height:40px;position:absolute;right:0;bottom:0;background:#000;color:#fff;text-align:center;line-height:40px;z-index:10}.zmiti-stage-main-ui .zmiti-top{position:absolute;top:10px;left:6rem;z-index:10;width:1.8rem;height:1.8rem}.zmiti-stage-main-ui .zmiti-top .zmiti-clock{margin:0 auto;text-align:center;line-height:2rem;font-weight:700;font-size:.6rem;color:#fff552;z-index:100}.zmiti-stage-main-ui .zmiti-img-operator{position:absolute;width:100%;height:100%;left:0;top:0;overflow:hidden;background:rgba(0,0,0,.9);z-index:9999}.zmiti-stage-main-ui .zmiti-img-operator .zmiti-img-C{width:90%;position:relative;margin:.5rem auto}.zmiti-stage-main-ui .zmiti-img-operator .zmiti-img-C img{opacity:.4}.zmiti-stage-main-ui .zmiti-img-operator .zmiti-img-C div{position:absolute;border:1px solid #fff;left:0;top:0}.zmiti-stage-main-ui .zmiti-img-operator>header{position:relative;width:100%;height:1rem;line-height:1rem;background:#eee}.zmiti-stage-main-ui .zmiti-img-operator>header span{position:absolute;width:1.2rem;height:100%;left:.2rem;top:0;text-align:center}.zmiti-stage-main-ui .zmiti-img-operator>header span:nth-of-type(2){right:.2rem;left:auto}.zmiti-stage-main-ui .zmiti-xiaoxin{position:absolute;bottom:0;left:0;z-index:100}.zmiti-stage-main-ui .zmiti-xiaoxin img:nth-of-type(2){position:absolute;top:0;width:5rem;z-index:10;left:2rem}.zmiti-stage-main-ui .zmiti-error-mask{position:absolute;width:100%;height:100%;left:0;top:0;z-index:1999;background:rgba(0,0,0,.7)}.zmiti-stage-main-ui .zmiti-error-mask input{position:absolute;width:6rem;left:0;top:0;height:9rem;z-index:10;opacity:0}.zmiti-stage-main-ui .zmiti-error-mask .zmiti-drag{position:absolute;left:2rem;top:1.5rem;z-index:10;color:#fff;font-weight:700;width:8rem;font-size:.5rem;line-height:.8rem}.zmiti-stage-main-ui .zmiti-error-mask .zmiti-drag img{width:.8rem;position:absolute;left:50%;margin-left:-.4rem;margin-top:.4rem;-webkit-animation:arMove 1.2s infinite;animation:arMove 1.2s infinite}.zmiti-stage-main-ui .zmiti-error-mask article{margin-top:1rem}.zmiti-stage-main-ui .zmiti-error-mask article img{width:40%;margin-left:10px}.zmiti-stage-main-ui .zmiti-error-mask section{left:0;top:0;opacity:.8;background:#fff;width:6rem;height:6rem;overflow:hidden;position:relative;box-shadow:0 0 0 8px rgba(254,185,52,.4),0 0 0 16px rgba(254,185,52,.2);border-radius:3rem}.zmiti-stage-main-ui .zmiti-error-mask section.active{-webkit-transition:left 1s,top 1s;top:6.5rem;left:-2.5rem}.zmiti-stage-main-ui .zmiti-error-mask section img{position:absolute;left:0;top:0;width:7rem}.zmiti-stage-main-ui .zmiti-error-mask section img.zmiti-rimg{width:6rem}.zmiti-stage-main-ui .zmiti-error-mask div{text-align:center;left:50%;margin-left:-3rem;margin-top:-4rem;top:50%;width:6rem;height:8rem;position:relative}.zmiti-stage-main-ui .zmiti-error-mask div .zmiti-finish-content{width:6rem;position:absolute;bottom:0;left:1.1rem}.zmiti-stage-main-ui .zmiti-error-mask .zmiti-result-img{position:absolute;width:6rem;top:0;left:50%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0)}.zmiti-stage-main-ui .zmiti-xx{position:absolute;left:1.5rem;width:7rem;top:40%;z-index:100}.zmiti-stage-main-ui .zmiti-xx .zmiti-person{width:2rem}.zmiti-stage-main-ui .zmiti-xx .zmiti-tip{width:5rem;position:absolute}@-webkit-keyframes ripples{to{background:#feb934;opacity:0;-webkit-transform:scale(1.4);transform:scale(1.4)}}@-webkit-keyframes meteorMove{to{-webkit-transform:translate3d(-24rem,24rem,0);transform:translate3d(-24rem,24rem,0)}}@-webkit-keyframes arMove{to{-webkit-transform:translate3d(0,12px,0);transform:translate3d(0,12px,0)}}',""]);
},183:function(t,exports,e){try{(function(){"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),o=function(t,e,i){for(var a=!0;a;){var n=t,r=e,o=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var c=Object.getPrototypeOf(n);if(null===c)return;t=c,e=r,i=o,a=!0,s=c=void 0}},s=e(1),l=t(s),c=e(172),u=t(c),m=function(t){return function(e){function s(t){i(this,s),o(Object.getPrototypeOf(s.prototype),"constructor",this).call(this,t),this.state={}}return a(s,e),r(s,[{key:"componentWillMount",value:function(){}},{key:"log",value:function(t){u.default.ajax({url:window.baseUrl+"msg/send_msg",data:{type:t.key||"log",content:JSON.stringify(t)}})}},{key:"render",value:function(){var e={log:this.log};return l.default.createElement(t,n({},e,this.props,this.state))}}]),s}(s.Component)};exports.PubCom=m}).call(this)}finally{}},184:function(t,exports,e){try{(function(){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),o=function(t,e,i){for(var a=!0;a;){var n=t,r=e,o=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var c=Object.getPrototypeOf(n);if(null===c)return;t=c,e=r,i=o,a=!0,s=c=void 0}},s=e(1),l=i(s),c=e(183);e(185);var u=e(172),m=(i(u),function(t){function e(t){a(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={},this.viewW=document.documentElement.clientWidth,this.viewH=document.documentElement.clientHeight}return n(e,t),r(e,[{key:"render",value:function(){return l.default.createElement("div",{className:"zmiti-toast-main"},l.default.createElement("div",{className:"zmiti-toast-main-ui"},this.props.toast||""))}},{key:"componentDidMount",value:function(){}}]),e}(s.Component));exports.default=(0,c.PubCom)(m),t.exports=exports.default}).call(this)}finally{}},185:function(t,exports,e){var i=e(186);"string"==typeof i&&(i=[[t.id,i,""]]);e(177)(i,{});i.locals&&(t.exports=i.locals)},186:function(t,exports,e){exports=t.exports=e(176)(),exports.push([t.id,".lt-full{width:100%;height:100%;position:absolute;left:0;top:0}.zmiti-text-overflow{overflow:hidden;white-space:nowrap;word-break:break-all;text-overflow:ellipsis;-webkit-text-overflow:ellipsis}.zmiti-toast-main-ui{background:rgba(0,0,0,.7);position:absolute;top:30%;left:50%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);padding:10px;text-align:center;color:#fff;width:50%;border-radius:10px;z-index:99999;font-size:.5rem}.zmiti-toast-main{position:absolute;width:100%;height:100%;left:0;top:0;z-index:10001}",""])},187:function(module,exports,__webpack_require__){try{(function(){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),_get=function(t,e,i){for(var a=!0;a;){var n=t,r=e,o=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var c=Object.getPrototypeOf(n);if(null===c)return;t=c,e=r,i=o,a=!0,s=c=void 0}},_react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(32),_reactDom2=_interopRequireDefault(_reactDom),_jquery=__webpack_require__(172),_jquery2=_interopRequireDefault(_jquery);__webpack_require__(188);var _componentsPublicPubJsx=__webpack_require__(183),_componentsToastIndexJsx=__webpack_require__(184),_componentsToastIndexJsx2=_interopRequireDefault(_componentsToastIndexJsx),data={wxappid:"wxec2401ee9a70f3d9",wxappsecret:"fc2c8e7c243da9e8898516fa5da8cbbb"},ZmitiShareApp=function(_Component){function ZmitiShareApp(t){_classCallCheck(this,ZmitiShareApp),_get(Object.getPrototypeOf(ZmitiShareApp.prototype),"constructor",this).call(this,t),this.state={className:"",fuxinClass:"",headimg:"",clock:0,count:0,clipUrl:"",domClass:"",showMask:!1,transX:0,transY:0,rotate:0},this.viewW=document.documentElement.clientWidth,this.viewH=document.documentElement.clientHeight}return _inherits(ZmitiShareApp,_Component),_createClass(ZmitiShareApp,[{key:"getQueryString",value:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?i[2]:null}},{key:"render",value:function(){var t=this,e={background:"url(./assets/images/arron1.png) no-repeat center  top",backgroundSize:"cover"},i={background:"url(./assets/images/bg1.jpg) no-repeat center",backgroundSize:"cover"};return _react2.default.createElement("div",{className:"zmiti-share-main-ui "+this.state.className,style:i},_react2.default.createElement("audio",{src:"./assets/music/1.mp3",ref:"clipaudio"}),_react2.default.createElement("section",{ref:"zmiti-share-content",style:{height:this.viewH},className:"zmiti-share-content "+this.state.domClass},_react2.default.createElement("div",{className:"zmiti-share-top"},_react2.default.createElement("img",{src:"./assets/images/share-top.png"})),_react2.default.createElement("div",{className:"zmiti-fuxin "+this.state.fuxinClass},_react2.default.createElement("img",{src:"./assets/images/fuxin.png"})),_react2.default.createElement("div",{className:"zmiti-ar1 "+this.state.fuxinClass},_react2.default.createElement("img",{src:"./assets/images/ar1.png"})),_react2.default.createElement("div",{className:"zmiti-ar2 "+this.state.fuxinClass},_react2.default.createElement("img",{src:"./assets/images/ar2.png"})),_react2.default.createElement("div",{className:"zmiti-share-bottom"},_react2.default.createElement("img",{src:"./assets/images/share-bottom.png"})),_react2.default.createElement("div",{className:"zmiti-bottom-bg"}),this.state.qrcode&&_react2.default.createElement("div",{className:"zmiti-qrcode"},_react2.default.createElement("img",{src:this.state.qrcode||"./assets/images/qrcode.png"})),_react2.default.createElement("div",{className:"zmiti-fuxin-text"},_react2.default.createElement("div",{className:"zmiti-head "+(0!==this.state.rotate?"active":"")},_react2.default.createElement("img",{src:this.state.headimg})),_react2.default.createElement("div",{className:"zmiti-text"},_react2.default.createElement("div",null,"我用",_react2.default.createElement("span",null,this.state.clock),"秒时间击败了",_react2.default.createElement("span",null,this.state.count),"人")," ",_react2.default.createElement("div",null," 点亮 ",_react2.default.createElement("span",null," 复兴之路 "),"走进十九大会场")))," "),this.state.clipUrl&&_react2.default.createElement("div",{className:"zmiti-photo "+(this.state.photoClass||"")},_react2.default.createElement("img",{src:this.state.clipUrl}),_react2.default.createElement("div",{ref:"zmiti-share-tip"},"长按图像保存到手机")),this.state.clipUrl&&_react2.default.createElement("div",{className:"zmiti-share-bottom-info "+(this.state.photoClass||"")},!this.state.src&&_react2.default.createElement("div",null,_react2.default.createElement("aside",null,_react2.default.createElement("div",null,_react2.default.createElement("a",{href:window.location.href.split("?")[0]},"再挑战一次"))),_react2.default.createElement("section",{style:{width:20}}),_react2.default.createElement("aside",null,_react2.default.createElement("div",{onClick:function(){t.setState({showMask:!0})}},"分享"))),this.state.src&&_react2.default.createElement("div",null,_react2.default.createElement("aside",{style:{margin:"0 auto"}},_react2.default.createElement("div",null,_react2.default.createElement("a",{href:window.location.href.split("?")[0]},"走复兴之路")))),_react2.default.createElement("div",null,_react2.default.createElement("img",{src:"./assets/images/copyright.png"})))," ",this.state.toast&&_react2.default.createElement(_componentsToastIndexJsx2.default,{toast:this.state.toast})," ",this.state.showMask&&_react2.default.createElement("div",{onTouchStart:function(){t.setState({showMask:!1})},className:"zmiti-mask",style:e})," ")}},{key:"animate",value:function(){var t=this;this.setState({fuxinClass:"active"}),setTimeout(function(){t.clipImg()},2e3)}},{key:"createQrCode",value:function(){var t=arguments.length<=0||void 0===arguments[0]?window.location.href.split("?")[0]:arguments[0],e=this;_jquery2.default.ajax({type:"post",url:"http://api.zmiti.com/v2/share/create_qrcode",data:{url:t}}).done(function(t){0===t.getret&&e.setState({qrcode:t.qrcodeurl})})}},{key:"clipImg",value:function(){var t=this.refs["zmiti-share-content"],e=this,i=this.props,a=i.changeURLPar,n=i.wxConfig;html2canvas(t,{useCORS:!0,onrendered:function(t){var i=t.toDataURL();e.setState({clipUrl:i,toast:""}),_jquery2.default.ajax({url:"http://api.zmiti.com/v2/share/base64_image/",type:"post",data:{setcontents:i,setimage_w:e.viewW,setimage_h:e.viewH},success:function(t){if(0===t.getret){var i=t.getimageurl,r=window.clipShare.title.replace(/{clock}/gi,e.state.clock);r=r.replace(/{count}/gi,e.state.count);var o=window.clipShare.desc.replace(/{clock}/gi,e.state.clock);o=o.replace(/{count}/gi,e.state.count);var s=window.location.href.split("#")[0];s=a(s,"src",i),n(r,o,window.clipShare.img,s),e.setState({clipUrl:i,domClass:"hide"}),setTimeout(function(){e.setState({photoClass:"active"}),e.refs["zmiti-share-tip"].style.display="block"},1e3)}}})},width:e.viewW,height:e.viewH})}},{key:"componentDidMount",value:function(){var t=this,e=this.props,i=e.obserable,a=(e.wxConfig,e.log,e.nickname,e.changeURLPar,e.border,e.file,e.wish,e.transX,e.transY,this),n=a.getQueryString("src");n?this.setState({clipUrl:n,src:n,domClass:"hide",photoClass:"active"}):a.createQrCode(),i.on("showShare",function(e){var i={className:"",duration:e.duration,gk:e.gk,nickname:e.nickname};e.src&&(i.src=e.src),t.setState(i)}),setTimeout(function(){},2e3),i.on("setHeadimg",function(e){t.setState({headimg:e.headimg,count:e.count,clock:e.clock,rotate:e.rotate,transX:e.transX/4,transY:e.transY/4}),setTimeout(function(){t.animate()},1e3)})}},{key:"changeURLPar",value:function changeURLPar(url,arg,val){var pattern=arg+"=([^&]*)",replaceText=arg+"="+val;return url.match(pattern)?url.replace(eval("/("+arg+"=)([^&]*)/gi"),replaceText):url.match("[?]")?url+"&"+replaceText:url+"?"+replaceText}}]),ZmitiShareApp}(_react.Component);exports.default=(0,_componentsPublicPubJsx.PubCom)(ZmitiShareApp),module.exports=exports.default}).call(this)}finally{}},188:function(t,exports,e){var i=e(189);"string"==typeof i&&(i=[[t.id,i,""]]);e(177)(i,{});i.locals&&(t.exports=i.locals)},189:function(t,exports,e){exports=t.exports=e(176)(),exports.push([t.id,".lt-full{width:100%;height:100%;position:absolute;left:0;top:0}.zmiti-text-overflow{overflow:hidden;white-space:nowrap;word-break:break-all;text-overflow:ellipsis;-webkit-text-overflow:ellipsis}.zmiti-share-main-ui{position:absolute;left:0;top:0;width:10rem;height:100%;z-index:2010;overflow:hidden;background:#eee}.zmiti-share-main-ui.hide{display:none}.zmiti-share-main-ui .zmiti-share-content{background:#56c6ff}.zmiti-share-main-ui .zmiti-share-content.hide{display:none}.zmiti-share-main-ui .zmiti-share-top{width:5rem;position:absolute;left:0;top:0}.zmiti-share-main-ui .zmiti-share-bottom{width:10rem;position:absolute;left:0;bottom:2rem}.zmiti-share-main-ui .zmiti-bottom-bg{width:20rem;left:-5rem;height:16rem;bottom:0;-webkit-transform:translate3d(0,12rem,0);transform:translate3d(0,12rem,0);background:#fff;border-radius:10rem/8rem;position:absolute;z-index:100}.zmiti-share-main-ui .zmiti-qrcode{position:absolute;width:2rem;right:.2rem;bottom:.5rem;z-index:101}.zmiti-share-main-ui .zmiti-mask{position:fixed;z-index:10000;left:0;top:0;width:100%;height:100%}.zmiti-share-main-ui .zmiti-photo{position:absolute;-webkit-transform-origin:center 2rem;transform-origin:center 2rem;border:2px solid #b52222;padding:10px}.zmiti-share-main-ui .zmiti-photo img{box-shadow:0 0 0 5px #b52222}.zmiti-share-main-ui .zmiti-photo.active{transition:.4s;-webkit-transform:scale(.7);transform:scale(.7)}.zmiti-share-main-ui .zmiti-photo div{width:20px;position:absolute;display:none;right:-24px;bottom:0;color:#b52222}.zmiti-share-main-ui .zmiti-share-bottom-info{position:absolute;width:60%;bottom:.5rem;left:20%;-webkit-transform:translate3d(0,300px,0);transform:translate3d(0,300px,0)}.zmiti-share-main-ui .zmiti-share-bottom-info.active{-webkit-transform:translateZ(0);transform:translateZ(0);transition:.4s .2s}.zmiti-share-main-ui .zmiti-share-bottom-info>div{display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:horizontal}.zmiti-share-main-ui .zmiti-share-bottom-info>div aside div{border-radius:10px}.zmiti-share-main-ui .zmiti-share-bottom-info>div:first-of-type > aside{-webkit-box-flex:1}.zmiti-share-main-ui .zmiti-share-bottom-info>div:first-of-type > aside:nth-of-type(2) div{width:2rem}.zmiti-share-main-ui .zmiti-share-bottom-info>div:first-of-type a{color:#fff;display:block;width:100%;height:100%}.zmiti-share-main-ui .zmiti-share-bottom-info>div:first-of-type div{width:3.2rem;height:30px;line-height:30px;text-align:center;background:#b52222;color:#fff}.zmiti-share-main-ui .zmiti-share-bottom-info>div:nth-of-type(2){height:2rem}.zmiti-fuxin{width:4rem;position:absolute;left:3rem;top:2rem;transition:.4s;-webkit-transform:scale(0);transform:scale(0)}.zmiti-fuxin.active{-webkit-transform:scale(1);transform:scale(1)}.zmiti-ar1,.zmiti-ar2{position:absolute;width:2rem;left:2.4rem;top:5rem;-webkit-transform:translate3d(-300px,300px,0);transform:translate3d(-300px,300px,0)}.zmiti-ar1.active,.zmiti-ar2.active{transition:.5s .4s;-webkit-transform:translateZ(0);transform:translateZ(0)}.zmiti-ar2{left:6rem;top:2rem;-webkit-transform:translate3d(300px,-300px,0);transform:translate3d(300px,-300px,0)}.zmiti-share-main-ui .zmiti-fuxin-text{position:absolute;left:.2rem;bottom:.2rem;z-index:100;width:7.3rem;height:2.5rem;padding-left:10px;font-size:12px}.zmiti-share-main-ui .zmiti-fuxin-text .zmiti-text{position:absolute;left:2rem;top:.4rem;line-height:.8rem}.zmiti-share-main-ui .zmiti-fuxin-text .zmiti-head{width:1.5rem;height:1.5rem;padding:4px;background:#fff;border-radius:1rem;overflow:hidden;position:absolute;z-index:100;margin-top:.4rem;margin-left:-.2rem}.zmiti-share-main-ui .zmiti-fuxin-text .zmiti-head.active img{width:2.5rem;left:-.25rem;top:-.05rem}.zmiti-share-main-ui .zmiti-fuxin-text .zmiti-head img{width:2rem;left:-.25rem;top:-.25rem;position:relative}.zmiti-share-main-ui .zmiti-fuxin-text span{left:.7rem;width:1.3rem;top:-.1rem;text-align:center;font-weight:700;color:#fb4f51;font-size:.4rem;overflow:hidden;max-width:1.3rem;padding:0 2px}",""])},190:function(t,exports,e){try{(function(){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),o=function(t,e,i){for(var a=!0;a;){var n=t,r=e,o=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var c=Object.getPrototypeOf(n);if(null===c)return;t=c,e=r,i=o,a=!0,s=c=void 0}},s=e(1),l=i(s),c=e(32),u=(i(c),e(172)),m=(i(u),e(173));i(m);e(191);var f=e(183),p=function(t){function e(t){a(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={className:"",fuxinClass:"",textClass:""},this.viewW=document.documentElement.clientWidth,this.viewH=document.documentElement.clientHeight,window.s=this}return n(e,t),r(e,[{key:"render",value:function(){var t={background:"#56c6ff url(./assets/images/index-bottom.png) no-repeat center bottom",backgroundSize:"contain"};return l.default.createElement("div",{style:t,className:"zmiti-index-main-ui "+this.state.className},l.default.createElement("div",{className:"zmiti-fuxin "+this.state.fuxinClass},l.default.createElement("img",{src:"./assets/images/fuxin.png"})),l.default.createElement("div",{className:"zmiti-ar1 "+this.state.fuxinClass},l.default.createElement("img",{src:"./assets/images/ar1.png"})),l.default.createElement("div",{className:"zmiti-ar2 "+this.state.fuxinClass},l.default.createElement("img",{src:"./assets/images/ar2.png"})),l.default.createElement("footer",{className:"zmiti-index-footer"},l.default.createElement("div",{onClick:this.beginGame.bind(this)},l.default.createElement("img",{src:"./assets/images/index-begin-btn.png"})),l.default.createElement("section",{className:"zmiti-index-text "+this.state.textClass},"中国共产党第十九次全国代表大会召开啦！请随小新一起将六个历史事件按时间顺序依次点亮，即可通过“复兴之路”迈向十九大会场！")))}},{key:"beginGame",value:function(){this.setState({className:"hide"});var t=this.props.obserable;t.trigger({type:"stageAnimate"})}},{key:"animate",value:function(){this.setState({fuxinClass:"active",textClass:"active"})}},{key:"showToast",value:function(t){var e=this;this.setState({toast:t}),setTimeout(function(){e.setState({toast:""})},2e3)}},{key:"componentDidMount",value:function(){var t=this;setTimeout(function(){t.animate()},1e3);var e=this.props.obserable;e.on("toggleIndex",function(e){t.setState({className:e})})}}]),e}(s.Component);exports.default=(0,f.PubCom)(p),t.exports=exports.default}).call(this)}finally{}},191:function(t,exports,e){var i=e(192);"string"==typeof i&&(i=[[t.id,i,""]]);e(177)(i,{});i.locals&&(t.exports=i.locals)},192:function(t,exports,e){exports=t.exports=e(176)(),exports.push([t.id,".lt-full{width:100%;height:100%;position:absolute;left:0;top:0}.zmiti-text-overflow{overflow:hidden;white-space:nowrap;word-break:break-all;text-overflow:ellipsis;-webkit-text-overflow:ellipsis}.zmiti-index-main-ui{width:100%;height:100%;transition:.3s;left:0;top:0;background:#56c6ff;z-index:100;position:absolute;z-index:2110}.zmiti-index-main-ui.hide{display:none}.zmiti-index-main-ui .zmiti-index-footer{position:absolute;bottom:2.5rem;left:0;height:5rem}.zmiti-index-main-ui .zmiti-index-footer>div{position:absolute;width:4rem;left:3rem;top:3rem;-webkit-animation:scale 1s linear infinite alternate;animation:scale 1s linear infinite alternate}.zmiti-index-main-ui .zmiti-fuxin{width:4rem;position:absolute;left:3rem;top:.5rem;transition:.4s;-webkit-transform:scale(0);transform:scale(0)}.zmiti-index-main-ui .zmiti-fuxin.active{-webkit-transform:scale(1);transform:scale(1)}.zmiti-index-main-ui .zmiti-ar1,.zmiti-index-main-ui .zmiti-ar2{position:absolute;width:2rem;left:2.4rem;top:4rem;-webkit-transform:translate3d(-300px,300px,0);transform:translate3d(-300px,300px,0)}.zmiti-index-main-ui .zmiti-ar1.active,.zmiti-index-main-ui .zmiti-ar2.active{transition:.5s .4s;-webkit-transform:translateZ(0);transform:translateZ(0)}.zmiti-index-main-ui .zmiti-index-text{position:absolute;width:8rem;left:1rem;color:#fff;top:-1.52rem;font-size:.45rem;text-indent:2em;line-height:.8rem;opacity:0;transition:2s 1s}.zmiti-index-main-ui .zmiti-index-text.active{opacity:1}.zmiti-index-main-ui .zmiti-ar2{left:6rem;top:1rem;-webkit-transform:translate3d(300px,-300px,0);transform:translate3d(300px,-300px,0)}@-webkit-keyframes scale{0%{-webkit-transform:scale(.97);transform:scale(.97)}to{-webkit-transform:scale(1.03);transform:scale(1.03)}}@media (max-height:504px){.zmiti-index-main-ui .zmiti-index-text{line-height:.8rem}}@media (max-height:612px) and (min-width:412px){.zmiti-index-main-ui .zmiti-index-text{top:-1.1rem}}",""])}});